# **Разработка системы предсказание температуры расплава.**

**Дано** семь таблиц, в которых столбец `'key'` содержит номер партии:
1. *steel.data_arc* — данные об электродах: номер партии, время начала нагрева, время окончания нагрева, значение активной мощности, значение реактивной мощности.
2. *steel.data_bulk* — данные об объёме сыпучих материалов: номер партии, объём подаваемого материала.
3. *steel.data_bulk_time* — данные о времени подачи сыпучих материалов: номер партии, время подачи материала.
4. *steel.data_gas* — данные о продувке сплава газом: номер партии, объём подаваемого газа.
5. *steel.data_temp* — данные об измерениях температуры: номер партии, время замера, значение температуры.
6. *steel.data_wire* — данные об объёме проволочных материалов: номер партии, объём подаваемых проволочных материалов.
7. *steel.data_wire_time* — данные о времени подачи проволочных материалов: номер партии, время подачи проволочных материалов.

**Цель:** оптимизация производственных расходов за счёт уменьшения потребления электроэнергии на этапе обработки стали.

**Поставленная задача** построить модель предсказания температуры сплава для моделирования технологического процесса.

## Применяемые библиотеки: 

pandas, numpy, seaborn, plotly, sklearn, scipy, phik, shap, feature_engine, sqlalchemy, optuna, xgboost, catboost, lightgbm, lineartree, torch

## Вывод

1. **Обучение моделей.**
   Результаты подбора гиперпараметров для моделей Ridge, LinearBoostRegressor, CatBoostRegressor и 4-ё слойная полносвязная нейронная сеть (FCNN):

    - Ridge - очень быстрая и простая модель, которая даёт приемлемый результат.
    - LinearBoostRegressor - менее точная и медленная модель по сравнению с Ridge.
    - CatBoostRegressor - даёт хорошее и стабильное качество работы с приемлемой скоростью.
    - FCNN - даёт лучшее качество целевой метрики, однако результаты различных итераций обучения модели обладают высокой дисперсией, что в целом делают её близкой по качеству с CatBoostRegressor.

    | Модели регрессии              | MAE   | R2    |
    | ----------------------------- | ----- | ----- |
    | Ridge                         | 6.113 | 0.464 |
    | LinearBoostRegressor          | 6.225 | 0.441 |
    | CatBoostRegressor             | 6.018 | 0.475 |
    | FCNN                          | 5.918 | ----- |
    
    Резюмируя результаты приходим к выводу, что хоть и модель FCNN даёт лучшую метрику на test, различие целевых метрик между test и train показывает, что модель обладает признаками переобучения. В связи с этим выбор     падает на CatBoostRegressor, дающий следующий по качеству после FCNN результат.

2. **Тестирование лучшего решения по ML** показало, что целевая метрика MAE модели CatBoostRegressor (mae=6.084) на 24% меньше метрики MAE для константной модели DummyRegressor (mae=8), что свидетельствует об адекватности модели. Более разительные результаты можно увидеть по метрике R2 для тестевой выборки 0.452, а для 'глупого регрессора' 0. Модель CatBoostRegressor не только заметно превосходит простую константную модель, но и объясняет 45% вариации целевого признака. Наиболее значимыми признаками являются 'init_temp', 'duration_heat_sum' и 'active_power_mean' которые по своей сути отражают начальные параметры системы и количество переданной ей энергии, поэтому данные признаки наиболее значимо влияют на прогнозирование конечной температуры, чем выше значения указанных признаков, тем более высокая температура будет прогнозироваться. Остальные признаки, хотя и менее значимы, могут влиять на общую динамику системы. Важно учитывать их в контексте, чтобы получить более точные прогнозы.

---
Автор: Евтухов Павел

E-mail: xswepp@tut.by

https://t.me/xswepp

