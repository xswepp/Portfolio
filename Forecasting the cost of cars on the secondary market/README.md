# Прогнозирование стоимости автомобилей на вторичном рынке (соревнования на Kaggle)

**Дано:** два файла включающий 15/14 столбцов с размеченными и не размеченными данными в 440236/110058 строк.
- `'year'` - год выпуска автомобиля;
- `'make'` - марка автомобиля;
- `'model'` - издание автомобиля определенной марки;
- `'trim'` - уровни отделки салона автомобиля (разные версии модели);
- `'body'` - тип кузова транспортного средства (относится к форме и модели конкретной марки автомобиля);
- `'transmission'` - механизм, который передает мощность от двигателя к колесам;
- `'vin'` - идентификационный номер транспортного средства;
- `'state'` - состояние, в котором автомобиль выставлен на аукцион;
- `'condition'` - состояние автомобилей на момент аукциона;
- `'odometer'` - расстояние, пройденное автомобилем с момента выпуска;
- `'color'` - цвет кузова автомобиля;
- `'interior'` - цвет салона автомобиля;
- `'seller'` - продавец автомобиля, автосалоны;
- `'sellingprice'` - цена, по которой автомобиль был продан на аукционе;
- `'saledate'` - дата продажи автомобиля.

**Цель:** разработать модель предсказания стоимости автомобиля на вторичном рынке.

## Применяемые библиотеки: 

pandas, numpy, seaborn, plotly, sklearn, category_encoders, phik, optuna, requests, xgboost, lightgbm, scipy, association_metrics, shap, catboost

## Вывод

- **Разработка модели ML.** 
    - Лучшие результаты показали модели XGBRegressor, CatBoostRegressor и RandomForestRegressor, которые дают на безлайне значение целевой метрики в диапазоне 18,5-16,5%. От модели RandomForestRegressor решено отказать по причине отсутствия достаточного обьёма вычислительных ресурсов. 
    - Исследование важности признаков показало, что все признаки обладают классифицирующими свойствами лучше, чем случайный набор значений. Удаление некоторых признаков одназначло приводит к увеличению значения целевой метрики безлайновых моделей (за исключением `'vin'`). 
    - Наилучший результат получен при использовании CatBoostRegressor. При установленной величине достаточности метрики качества МАРЕ, равной 20%, получен сильный результат, равный 12,5%. Качество модели весьма сильное, на что указывает низкое значение стандартного отклонения 0,093 и величина 95%-го доверительного интервала 12,25-12,77%.

- **Разработка мультимодельного подхода для ML.** С целью поиска подхода по улучшению значения целевой метрики, решено исследовать вариант расчленения исследуемой выборки на наиболее типичные выборки и построить прогнозирование по отдельности. Самый сильный коэффициент корреляции Фи связи с целевым признаком `'sellingprice'` принадлежит признаку `'model'`, построив от ранжированный график заметно сильное отличие равномерной линии тренда роста стоимости автомобилей, от стоимости автомобилей люксового сегмента. Наиболее оптимальный алгоритм разделения основывался на поиске минимального количества выбросов в разделяемых выборках. Таким образом были получен наиболее оптимальный алгоритм разделения, включающий в себя:
    - типичные бренды различной стоимостной категории 98.53% наблюдений.
    - люксовый сегмент 0.98% наблюдений.
    - сверх люксовый сегмент 0.50% наблюдений.
    
    Полученная целевая метрика на валидации MAPE=0.055 в 2,3 раза качественнее предыдущей модели ML.

- **Итоги соревнований на платформе Keggle.** 
    - Private Score = 12.3605
    - Public Score = 11.95535

    Занято второеместо в списке зачёта.
    ```
    https://www.kaggle.com/competitions/used-cars-price-prediction-21ds/leaderboard
    ```

---
Автор: Евтухов Павел

E-mail: xswepp@tut.by

https://t.me/xswepp
