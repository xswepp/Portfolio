# Прогнозирование спроса на товары повседневного использования

**Дано:** исторические данные о продажах трех категорий товаров (пиво, сигареты, анальгетики) с демографическими характеристиками магазинов.

**Цель:** построить модель для прогнозирования недельного спроса на основе исторических данных. Прогноз выполняется для трех категорий товаров с использованием данных предыдущей недели.

## Структура проекта

- `Тетрадка - тестовое задание.ipynb` - основной файл с полным анализом и построением моделей
- Данные загружаются из файлов формата parquet:
  - `beer_sales_data.parquet`, `cig_sales_data.parquet`, `ana_sales_data.parquet` - данные о продажах
  - `demographic_data.parquet` - демографические данные магазинов
  - `beer_upc.parquet`, `cig_upc.parquet`, `ana_upc.parquet` - данные о товарах

## Применяемые библиотеки

`pandas`, `numpy`, `scipy`, `seaborn`, `matplotlib`, `plotly`, `optuna`, `sklearn`, `catboost`, `statsmodels`, `tpot`, `phik`, `prophet`

## Основные этапы анализа

1. **Загрузка и объединение данных** - объединение данных продаж с UPC-кодами и демографическими данными
2. **Разведочный анализ данных (EDA)**:
   - Анализ распределения числовых признаков
   - Исследование пропущенных значений
   - Корреляционный анализ с использованием PhiK коэффициента
3. **Анализ временных рядов**:
   - Проверка стационарности (тест Дики-Фуллера)
   - Сезонная декомпозиция
4. **Построение и оптимизация моделей**:
   - Предобработка данных и создание признаков
   - Кросс-валидация временных рядов (TimeSeriesSplit)
   - Подбор гиперпараметров с использованием Optuna
   - Сравнение нескольких подходов (CatBoost, Prophet, TPOT)

## Результаты

### Лучшая модель
Наилучшие результаты показала модель **Prophet** с оптимизированными гиперпараметрами и регрессорами.

**Ключевые метрики:**
- MAPE (Mean Absolute Percentage Error) на валидации: **X.X%**
- Валидация с учетом временной структуры данных

### Особенности решения
- Учет временной природы данных через специальную кросс-валидацию
- Использование демографических характеристик магазинов как дополнительных признаков
- Автоматический подбор гиперпараметров с байесовской оптимизацией
- Анализ важности признаков для интерпретации модели

## Выводы

Модель Prophet показала наилучшую способность улавливать сложные зависимости в данных, включая сезонные паттерны и влияние демографических факторов.

Полученная модель может быть использована для:
- Оптимизации управление запасами
- Планирования закупок
- Выявления значимых факторов, влияющих на спрос

Построенная модель адекватно описывает закономерности в данных и может быть применена в практических задачах прогнозирования спроса в ритейле.

---

**Автор:** Евтухов Павел  
**E-mail:** xswepp@tut.by
**Telegram:** https://t.me/xswepp
